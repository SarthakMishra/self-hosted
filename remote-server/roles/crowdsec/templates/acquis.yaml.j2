# {{ ansible_managed }}
# CrowdSec Log Acquisition Configuration
# Generated by Ansible crowdsec role

{% for log_source in crowdsec_log_sources + (crowdsec_additional_log_sources | default([])) %}
{% if log_source.type == 'file' %}
# {{ log_source.description }}
filenames:
{% for filename in log_source.filenames %}
  - {{ filename }}
{% endfor %}
labels:
  type: {{ log_source.parser_type }}
{% if log_source.labels is defined %}
{% for key, value in log_source.labels.items() %}
  {{ key }}: {{ value }}
{% endfor %}
{% endif %}
---
{% elif log_source.type == 'journald' %}
# {{ log_source.description }}
journalctl_filter:
{% for filter in log_source.journalctl_filter %}
  - "{{ filter }}"
{% endfor %}
labels:
  type: {{ log_source.parser_type }}
{% if log_source.labels is defined %}
{% for key, value in log_source.labels.items() %}
  {{ key }}: {{ value }}
{% endfor %}
{% endif %}
---
{% endif %}
{% endfor %} 